<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator - Tender Monitoring System</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/calculator.css">
    <link rel="stylesheet" href="css/calculator.css">

</head>

<body>
    <!-- Header -->
    <header>
        <a href="index.html" class="header-img-link">
            <img src="img/south-africa.png" alt="SA Flag" class="header-img">
        </a>
        <h1>Tender Monitoring & Verification System</h1>
        <button id="themeToggle" onclick="toggleTheme()">🌙</button>
    </header>

    <!-- Navigation Bar -->
    <nav>
        <div class="nav-container">
            <a href="../user">Home</a>
            <a href="../user/">Tenders</a>
            <a href="../user/investors.html">Investors</a>
            <a href="../user/government.html">Government</a>
            <a href="../user/news.html">News</a>
            <a href="../user/calculator.html">Calculator</a>
            <a href="../admin/blockchain.html">Blockchain</a> <!-- Add this line -->
            <div class="dropdown">
                <button class="dropbtn">More ▼</button>
                <div class="dropdown-content">
                    <a href="../user/documents.html">Download Tender Documents</a>
                    <a href="../user/scoring.html">Tender 10-Point Scoring System</a>
                    <a href="../user/verify.html">Verify Project Reports</a>
                    <a href="../user/status.html">Project Status Updates</a>
                    <a href="../admin/blockchain.html">Blockchain Verification</a> <!-- Also keep it here -->
                </div>
            </div>
        </div>
    </nav>
    <!-- Calculator Content -->
    <div class="calculator-page-container">
        <h1>Tender Cost Calculator</h1>
        
        <div class="calculator-intro">
            <p>Use our comprehensive calculator tools to estimate costs, evaluate bids, and plan your tender submissions with confidence.</p>
        </div>
        
        <!-- Main Calculator -->
        <div class="calculator-section">
            <h2>Project Cost Estimator</h2>
            <p>Estimate the total cost of your project by entering the details below:</p>
            
            <div class="calculator-form">
                <div class="form-group">
                    <label for="materialCost">Material Costs (R)</label>
                    <input type="number" id="materialCost" placeholder="0.00" min="0">
                </div>
                
                <div class="form-group">
                    <label for="laborCost">Labor Costs (R)</label>
                    <input type="number" id="laborCost" placeholder="0.00" min="0">
                </div>
                
                <div class="form-group">
                    <label for="equipmentCost">Equipment Costs (R)</label>
                    <input type="number" id="equipmentCost" placeholder="0.00" min="0">
                </div>
                
                <div class="form-group">
                    <label for="overhead">Overhead Costs (R)</label>
                    <input type="number" id="overhead" placeholder="0.00" min="0">
                </div>
                
                <div class="form-group">
                    <label for="contingency">Contingency (%)</label>
                    <input type="number" id="contingency" placeholder="10" min="0" max="100" value="10">
                </div>
                
                <div class="form-group">
                    <label for="profit">Profit Margin (%)</label>
                    <input type="number" id="profit" placeholder="15" min="0" max="100" value="15">
                </div>
                
                <button onclick="calculateDetailedCost()">Calculate Total</button>
                
                <div class="results">
                    <div class="result-item">
                        <span>Subtotal:</span>
                        <span id="subtotal">R0.00</span>
                    </div>
                    <div class="result-item">
                        <span>Contingency Amount:</span>
                        <span id="contingencyAmount">R0.00</span>
                    </div>
                    <div class="result-item">
                        <span>Profit Amount:</span>
                        <span id="profitAmount">R0.00</span>
                    </div>
                    <div class="result-item total">
                        <span>Total Bid Amount:</span>
                        <span id="totalCost">R0.00</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Additional Calculators -->
        <div class="calculator-tabs">
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="openTab('timelineTab')">Project Timeline</button>
                <button class="tab-btn" onclick="openTab('roiTab')">ROI Calculator</button>
                <button class="tab-btn" onclick="openTab('comparisonTab')">Bid Comparison</button>
            </div>
            
            <div id="timelineTab" class="tab-content active">
                <h3>Project Timeline Calculator</h3>
                <p>Estimate your project timeline based on key milestones:</p>
                
                <div class="timeline-calculator">
                    <div class="form-group">
                        <label for="planningDays">Planning Phase (days)</label>
                        <input type="number" id="planningDays" min="1" value="30">
                    </div>
                    
                    <div class="form-group">
                        <label for="executionDays">Execution Phase (days)</label>
                        <input type="number" id="executionDays" min="1" value="90">
                    </div>
                    
                    <div class="form-group">
                        <label for="testingDays">Testing Phase (days)</label>
                        <input type="number" id="testingDays" min="1" value="15">
                    </div>
                    
                    <div class="form-group">
                        <label for="closureDays">Closure Phase (days)</label>
                        <input type="number" id="closureDays" min="1" value="15">
                    </div>
                    
                    <div class="form-group">
                        <label for="bufferPercentage">Buffer (%)</label>
                        <input type="number" id="bufferPercentage" min="0" max="100" value="20">
                    </div>
                    
                    <button onclick="calculateTimeline()">Calculate Timeline</button>
                    
                    <div class="timeline-result">
                        <p>Estimated project duration: <span id="totalDays">0</span> days</p>
                        <p>With start date of today, estimated completion: <span id="completionDate">-</span></p>
                    </div>
                </div>
            </div>
            
            <div id="roiTab" class="tab-content">
                <h3>Return on Investment Calculator</h3>
                <p>Calculate the potential ROI for your investment in a tender project:</p>
                
                <div class="roi-calculator">
                    <div class="form-group">
                        <label for="initialInvestment">Initial Investment (R)</label>
                        <input type="number" id="initialInvestment" min="0" placeholder="0.00">
                    </div>
                    
                    <div class="form-group">
                        <label for="projectRevenue">Expected Revenue (R)</label>
                        <input type="number" id="projectRevenue" min="0" placeholder="0.00">
                    </div>
                    
                    <div class="form-group">
                        <label for="projectDuration">Project Duration (months)</label>
                        <input type="number" id="projectDuration" min="1" value="12">
                    </div>
                    
                    <button onclick="calculateROI()">Calculate ROI</button>
                    
                    <div class="roi-result">
                        <p>Net Profit: <span id="netProfit">R0.00</span></p>
                        <p>ROI: <span id="roiPercentage">0%</span></p>
                        <p>Monthly Return: <span id="monthlyReturn">R0.00</span></p>
                    </div>
                </div>
            </div>
            
            <div id="comparisonTab" class="tab-content">
                <h3>Bid Comparison Tool</h3>
                <p>Compare up to three different bid options:</p>
                
                <div class="comparison-calculator">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Criteria</th>
                                <th>Option 1</th>
                                <th>Option 2</th>
                                <th>Option 3</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Bid Amount (R)</td>
                                <td><input type="number" id="bid1Amount" min="0" placeholder="0.00"></td>
                                <td><input type="number" id="bid2Amount" min="0" placeholder="0.00"></td>
                                <td><input type="number" id="bid3Amount" min="0" placeholder="0.00"></td>
                            </tr>
                            <tr>
                                <td>Timeline (days)</td>
                                <td><input type="number" id="bid1Timeline" min="0" placeholder="0"></td>
                                <td><input type="number" id="bid2Timeline" min="0" placeholder="0"></td>
                                <td><input type="number" id="bid3Timeline" min="0" placeholder="0"></td>
                            </tr>
                            <tr>
                                <td>Quality Score (1-10)</td>
                                <td><input type="number" id="bid1Quality" min="1" max="10" placeholder="5"></td>
                                <td><input type="number" id="bid2Quality" min="1" max="10" placeholder="5"></td>
                                <td><input type="number" id="bid3Quality" min="1" max="10" placeholder="5"></td>
                            </tr>
                            <tr>
                                <td>Risk Level (1-10)</td>
                                <td><input type="number" id="bid1Risk" min="1" max="10" placeholder="5"></td>
                                <td><input type="number" id="bid2Risk" min="1" max="10" placeholder="5"></td>
                                <td><input type="number" id="bid3Risk" min="1" max="10" placeholder="5"></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <button onclick="compareBids()">Compare Bids</button>
                    
                    <div class="comparison-result">
                        <p>Recommended option: <span id="recommendedBid">-</span></p>
                        <p>Recommendation reason: <span id="recommendationReason">-</span></p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Calculator Tips -->
        <div class="calculator-tips">
            <h2>Tips for Accurate Estimation</h2>
            <ul>
                <li>Always include a contingency amount for unexpected costs</li>
                <li>Research current material prices before submitting your bid</li>
                <li>Consider seasonal variations in labor and material costs</li>
                <li>Factor in compliance costs for regulatory requirements</li>
                <li>Don't underestimate overhead expenses like insurance and administration</li>
            </ul>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="footer-content">
            <p>© 2024 Tender Monitoring System | Designed for Transparency and Growth</p>
            <div class="social-media">
                <a href="#"><img src="img/facebook.png" alt="Facebook"></a>
                <a href="#"><img src="img/twitter.png" alt="Twitter"></a>
                <a href="#"><img src="img/linkedin.png" alt="LinkedIn"></a>
            </div>
        </div>
    </div>

    <!-- Back to Top Button -->
    <button id="backToTop" onclick="scrollToTop()">↑</button>

    <!-- Loading Spinner -->
    <div class="spinner" id="loadingSpinner"></div>

    <!-- Scripts -->
    <script src="js/script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize calculator page
        });

        function calculateDetailedCost() {
            const materialCost = parseFloat(document.getElementById('materialCost').value) || 0;
            const laborCost = parseFloat(document.getElementById('laborCost').value) || 0;
            const equipmentCost = parseFloat(document.getElementById('equipmentCost').value) || 0;
            const overhead = parseFloat(document.getElementById('overhead').value) || 0;
            const contingencyRate = parseFloat(document.getElementById('contingency').value) || 10;
            const profitRate = parseFloat(document.getElementById('profit').value) || 15;
            
            const subtotal = materialCost + laborCost + equipmentCost + overhead;
            const contingencyAmount = subtotal * (contingencyRate / 100);
            const profitAmount = subtotal * (profitRate / 100);
            const totalCost = subtotal + contingencyAmount + profitAmount;
            
            document.getElementById('subtotal').innerText = `R${subtotal.toFixed(2)}`;
            document.getElementById('contingencyAmount').innerText = `R${contingencyAmount.toFixed(2)}`;
            document.getElementById('profitAmount').innerText = `R${profitAmount.toFixed(2)}`;
            document.getElementById('totalCost').innerText = `R${totalCost.toFixed(2)}`;
        }

        function openTab(tabId) {
            // Hide all tab contents
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            // Remove active class from all tab buttons
            const tabButtons = document.getElementsByClassName('tab-btn');
            for (let i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove('active');
            }
            
            // Show the selected tab content and mark button as active
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        function calculateTimeline() {
            const planningDays = parseInt(document.getElementById('planningDays').value) || 0;
            const executionDays = parseInt(document.getElementById('executionDays').value) || 0;
            const testingDays = parseInt(document.getElementById('testingDays').value) || 0;
            const closureDays = parseInt(document.getElementById('closureDays').value) || 0;
            const bufferPercentage = parseInt(document.getElementById('bufferPercentage').value) || 0;
            
            const baseDays = planningDays + executionDays + testingDays + closureDays;
            const bufferDays = Math.round(baseDays * (bufferPercentage / 100));
            const totalDays = baseDays + bufferDays;
            
            // Calculate completion date
            const today = new Date();
            const completionDate = new Date(today);
            completionDate.setDate(today.getDate() + totalDays);
            
            document.getElementById('totalDays').innerText = totalDays;
            document.getElementById('completionDate').innerText = completionDate.toDateString();
            document.getElementById('totalDays').innerText = totalDays;
            document.getElementById('completionDate').innerText = completionDate.toDateString();
        }

        function calculateROI() {
            const initialInvestment = parseFloat(document.getElementById('initialInvestment').value) || 0;
            const projectRevenue = parseFloat(document.getElementById('projectRevenue').value) || 0;
            const projectDuration = parseInt(document.getElementById('projectDuration').value) || 1;

            const netProfit = projectRevenue - initialInvestment;
            const roiPercentage = ((netProfit / initialInvestment) * 100).toFixed(2);
            const monthlyReturn = (netProfit / projectDuration).toFixed(2);

            document.getElementById('netProfit').innerText = `R${netProfit.toFixed(2)}`;
            document.getElementById('roiPercentage').innerText = `${isFinite(roiPercentage) ? roiPercentage : 0}%`;
            document.getElementById('monthlyReturn').innerText = `R${monthlyReturn}`;
        }

        function compareBids() {
            const bids = [1, 2, 3].map(i => {
                return {
                    amount: parseFloat(document.getElementById(`bid${i}Amount`).value) || 0,
                    timeline: parseInt(document.getElementById(`bid${i}Timeline`).value) || 0,
                    quality: parseInt(document.getElementById(`bid${i}Quality`).value) || 0,
                    risk: parseInt(document.getElementById(`bid${i}Risk`).value) || 0,
                    index: i
                };
            });

            // Simple scoring formula: prioritize lower cost, timeline, and risk, and higher quality
            bids.forEach(bid => {
                bid.score = (10000 / (bid.amount + 1)) + (100 / (bid.timeline + 1)) + (bid.quality * 10) - (bid.risk * 5);
            });

            bids.sort((a, b) => b.score - a.score);
            const best = bids[0];

            document.getElementById('recommendedBid').innerText = `Option ${best.index}`;
            document.getElementById('recommendationReason').innerText = "Best combination of cost, quality, timeline, and risk.";
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const toggleBtn = document.getElementById('themeToggle');
            toggleBtn.innerText = document.body.classList.contains('dark-theme') ? '☀️' : '🌙';
        }
    </script>
</body>
</html>
